{
  "openapi": "3.1.2",
  "info": {
    "title": "EUDI Wallet Provider",
    "description": "A microservice acting as a Wallet Provider",
    "version": "0.0.1"
  },
  "paths": {
    "/challenge": {
      "post": {
        "tags": [
          "challenge"
        ],
        "operationId": "generateChallenge",
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ChallengeResponse"
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/wallet-instance-attestation/platform-key-attestation/android": {
      "post": {
        "tags": [
          "wallet-instance-attestation"
        ],
        "operationId": "issueAndroidPlatformKeyAttestationWalletInstanceAttestation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AndroidPlatformKeyAttestationWalletInstanceAttestationIssuanceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletInstanceAttestationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletInstanceAttestationErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/wallet-instance-attestation/platform-key-attestation/ios": {
      "post": {
        "tags": [
          "wallet-instance-attestation"
        ],
        "operationId": "issueIosPlatformKeyAttestationWalletInstanceAttestation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IosPlatformKeyAttestationWalletInstanceAttestationIssuanceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletInstanceAttestationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletInstanceAttestationErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/wallet-instance-attestation/jwk": {
      "post": {
        "tags": [
          "wallet-instance-attestation"
        ],
        "operationId": "issueJwkWalletInstanceAttestation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/JwkWalletInstanceAttestationIssuanceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletInstanceAttestationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletInstanceAttestationErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/wallet-unit-attestation/platform-key-attestation/android": {
      "post": {
        "tags": [
          "wallet-unit-attestation"
        ],
        "operationId": "issueAndroidPlatformKeyAttestationWalletUnitAttestation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AndroidPlatformKeyAttestationWalletUnitAttestationIssuanceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletUnitAttestationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletUnitAttestationErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/wallet-unit-attestation/platform-key-attestation/ios": {
      "post": {
        "tags": [
          "wallet-unit-attestation"
        ],
        "operationId": "issueIosPlatformKeyAttestationWalletUnitAttestation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IosPlatformKeyAttestationWalletUnitAttestationIssuanceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletUnitAttestationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletUnitAttestationErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/wallet-unit-attestation/jwk-set": {
      "post": {
        "tags": [
          "wallet-unit-attestation"
        ],
        "operationId": "issueJwkSetWalletUnitAttestation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/JwkSetWalletUnitAttestationIssuanceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletUnitAttestationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WalletUnitAttestationErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Challenge": {
        "type": "string",
        "format": "base64url"
      },
      "ChallengeResponse": {
        "type": "object",
        "properties": {
          "challenge": {
            "$ref": "#/components/schemas/Challenge"
          }
        },
        "required": [
          "challenge"
        ],
        "additionalProperties": false
      },
      "Certificate": {
        "description": "A Base64 Url-Safe DER encoded X509Certificate",
        "type": "string",
        "format": "base64url"
      },
      "CertificateChain": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Certificate"
        },
        "minItems": 1
      },
      "AndroidKeystoreAttestation": {
        "type": "object",
        "properties": {
          "x5c": {
            "$ref": "#/components/schemas/CertificateChain"
          }
        },
        "required": [
          "x5c"
        ],
        "additionalProperties": false
      },
      "AndroidPlatformKeyAttestationWalletInstanceAttestationIssuanceRequest": {
        "type": "object",
        "properties": {
          "keyAttestation": {
            "$ref": "#/components/schemas/AndroidKeystoreAttestation"
          },
          "challenge": {
            "$ref": "#/components/schemas/Challenge"
          }
        },
        "required": [
          "keyAttestation",
          "challenge"
        ],
        "additionalProperties": false
      },
      "IosHomebrewAttestation": {
        "type": "object",
        "properties": {
          "attestation": {
            "type": "string",
            "format": "base64url"
          },
          "clientDataJSON": {
            "type": "string",
            "format": "base64url"
          }
        },
        "required": [
          "attestation",
          "clientDataJSON"
        ],
        "additionalProperties": false
      },
      "IosPlatformKeyAttestationWalletInstanceAttestationIssuanceRequest": {
        "type": "object",
        "properties": {
          "keyAttestation": {
            "$ref": "#/components/schemas/IosHomebrewAttestation"
          },
          "challenge": {
            "$ref": "#/components/schemas/Challenge"
          }
        },
        "required": [
          "keyAttestation",
          "challenge"
        ],
        "additionalProperties": false
      },
      "Jwk": {
        "type": "object",
        "additionalProperties": true
      },
      "JwkWalletInstanceAttestationIssuanceRequest": {
        "type": "object",
        "properties": {
          "jwk": {
            "$ref": "#/components/schemas/Jwk"
          }
        },
        "required": [
          "jwk"
        ],
        "additionalProperties": false
      },
      "WalletInstanceAttestationResponse": {
        "type": "object",
        "properties": {
          "walletInstanceAttestation": {
            "type": "string"
          }
        },
        "required": [
          "walletInstanceAttestation"
        ],
        "additionalProperties": false
      },
      "WalletInstanceAttestationError": {
        "type": "string",
        "enum": [
          "invalid_challenge",
          "invalid_key_attestation",
          "unsupported_attested_key"
        ]
      },
      "WalletInstanceAttestationErrorResponse": {
        "type": "object",
        "properties": {
          "error": {
            "$ref": "#/components/schemas/WalletInstanceAttestationError"
          }
        },
        "required": [
          "error"
        ],
        "additionalProperties": false
      },
      "Nonce": {
        "type": "string"
      },
      "AndroidPlatformKeyAttestationWalletUnitAttestationIssuanceRequest": {
        "type": "object",
        "properties": {
          "nonce": {
            "$ref": "#/components/schemas/Nonce"
          },
          "keyAttestations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AndroidKeystoreAttestation"
            },
            "minItems": 1,
            "uniqueItems": true
          },
          "challenge": {
            "$ref": "#/components/schemas/Challenge"
          }
        },
        "required": [
          "keyAttestations",
          "challenge"
        ],
        "additionalProperties": false
      },
      "WalletUnitAttestationResponse": {
        "type": "object",
        "properties": {
          "walletUnitAttestation": {
            "type": "string"
          }
        },
        "required": [
          "walletUnitAttestation"
        ],
        "additionalProperties": false
      },
      "WalletUnitAttestationError": {
        "type": "string",
        "enum": [
          "invalid_challenge",
          "invalid_key_attestation",
          "unsupported_attested_key",
          "no_attested_keys",
          "non_unique_attested_keys"
        ]
      },
      "WalletUnitAttestationErrorResponse": {
        "type": "object",
        "properties": {
          "errors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WalletInstanceAttestationError"
            },
            "minItems": 1,
            "uniqueItems": true
          }
        },
        "required": [
          "errors"
        ],
        "additionalProperties": false
      },
      "IosPlatformKeyAttestationWalletUnitAttestationIssuanceRequest": {
        "type": "object",
        "properties": {
          "nonce": {
            "$ref": "#/components/schemas/Nonce"
          },
          "keyAttestations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IosHomebrewAttestation"
            },
            "minItems": 1,
            "uniqueItems": true
          },
          "challenge": {
            "$ref": "#/components/schemas/Challenge"
          }
        },
        "required": [
          "keyAttestations",
          "challenge"
        ],
        "additionalProperties": false
      },
      "JwkSet": {
        "type": "object",
        "properties": {
          "keys": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Jwk"
            },
            "minItems": 1,
            "uniqueItems": true
          }
        },
        "required": [
          "keys"
        ],
        "additionalProperties": false
      },
      "JwkSetWalletUnitAttestationIssuanceRequest": {
        "type": "object",
        "properties": {
          "nonce": {
            "$ref": "#/components/schemas/Nonce"
          },
          "jwkSet": {
            "$ref": "#/components/schemas/JwkSet"
          }
        },
        "required": [
          "jwkSet"
        ],
        "additionalProperties": false
      }
    }
  }
}